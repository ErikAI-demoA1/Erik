<!DOCTYPE html><html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>♟ Klasické šachy - podľa pravidiel FIDE</title>
  <style>
    body {
      background-color: #000;
      color: white;
      font-family: sans-serif;
      text-align: center;
    }
    h1 {
      color: red;
      font-size: 2em;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(8, 50px);
      grid-template-rows: repeat(8, 50px);
      margin: 0 auto;
      border: 2px solid white;
    }
    .cell {
      width: 50px;
      height: 50px;
      font-size: 36px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
    }
    .white { background-color: #eee; color: black; }
    .black { background-color: #444; color: white; }
    .selected { outline: 2px solid yellow; }
    button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1>♟ Klasické šachy – podľa pravidiel FIDE</h1>
  <h2 id="status">Na ťahu: Biely</h2>
  <div id="board"></div>
  <button onclick="startGame()">Nová hra</button>
  <button onclick="undoMove()">Späť ťah</button>  <script>
    const boardEl = document.getElementById("board");
    const statusEl = document.getElementById("status");
    let board = [];
    let selected = null;
    let turn = "w";
    let history = [];

    const pieces = {
      r: "♜", n: "♞", b: "♝", q: "♛", k: "♚", p: "♟",
      R: "♖", N: "♘", B: "♗", Q: "♕", K: "♔", P: "♙"
    };

    function initialBoard() {
      return [
        ["r","n","b","q","k","b","n","r"],
        ["p","p","p","p","p","p","p","p"],
        ["","","","","","","",""],
        ["","","","","","","",""],
        ["","","","","","","",""],
        ["","","","","","","",""],
        ["P","P","P","P","P","P","P","P"],
        ["R","N","B","Q","K","B","N","R"]
      ];
    }

    function drawBoard() {
      boardEl.innerHTML = "";
      for (let y = 0; y < 8; y++) {
        for (let x = 0; x < 8; x++) {
          const cell = document.createElement("div");
          cell.classList.add("cell");
          cell.classList.add((x + y) % 2 === 0 ? "white" : "black");
          cell.textContent = pieces[board[y][x]] || "";
          cell.dataset.x = x;
          cell.dataset.y = y;
          if (selected && selected.x == x && selected.y == y) cell.classList.add("selected");
          cell.onclick = () => cellClicked(x, y);
          boardEl.appendChild(cell);
        }
      }
    }

    function cellClicked(x, y) {
      const piece = board[y][x];
      if (selected) {
        const from = selected;
        const to = {x, y};
        if (from.x === to.x && from.y === to.y) {
          selected = null;
        } else if (isValidMove(from, to)) {
          history.push(JSON.parse(JSON.stringify(board)));
          board[to.y][to.x] = board[from.y][from.x];
          board[from.y][from.x] = "";
          turn = turn === "w" ? "b" : "w";
          selected = null;
        } else {
          selected = null;
        }
      } else if (piece && ((turn === "w" && piece === piece.toUpperCase()) || (turn === "b" && piece === piece.toLowerCase()))) {
        selected = {x, y};
      }
      drawBoard();
      statusEl.textContent = `Na ťahu: ${turn === "w" ? "Biely" : "Čierny"}`;
    }

    function isValidMove(from, to) {
      const dx = to.x - from.x;
      const dy = to.y - from.y;
      const piece = board[from.y][from.x];
      if (!piece) return false;
      const isWhite = piece === piece.toUpperCase();
      const target = board[to.y][to.x];
      if (target && (target === target.toUpperCase()) === isWhite) return false;
      return true; // základné pravidlo, neskôr pridáme detailné
    }

    function startGame() {
      board = initialBoard();
      selected = null;
      turn = "w";
      history = [];
      drawBoard();
      statusEl.textContent = "Na ťahu: Biely";
    }

    function undoMove() {
      if (history.length > 0) {
        board = history.pop();
        turn = turn === "w" ? "b" : "w";
        selected = null;
        drawBoard();
        statusEl.textContent = `Na ťahu: ${turn === "w" ? "Biely" : "Čierny"}`;
      }
    }

    startGame();
  </script></body>
</html>
