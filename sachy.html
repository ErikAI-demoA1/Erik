<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ErikAI – Šachy Pro originál</title>
  <style>
    body {
      background-color: #111;
      color: white;
      font-family: sans-serif;
      text-align: center;
    }
    h1 {
      color: red;
      font-size: 28px;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(8, 50px);
      justify-content: center;
      margin: 20px auto;
    }
    .cell {
      width: 50px;
      height: 50px;
      font-size: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .white { background: #eee; color: black; }
    .black { background: #555; color: white; }
    button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 16px;
    }
    .whitePiece { color: red; }
    .blackPiece { color: yellow; }
    #status {
      font-size: 20px;
      font-weight: bold;
      margin-top: 10px;
      color: #00ccff;
    }
  </style>
</head>
<body>
  <h1>♟ ErikAI- Šachy Pro originál </h1>

  <p id="cas" style="font-size: 18px;"></p>

  <script>
    function aktualizujCas() {
      const teraz = new Date();
      const moznosti = {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      };
      const casText = teraz.toLocaleDateString('sk-SK', moznosti);
      document.getElementById('cas').innerText = `🕓 Aktuálny čas: ${casText}`;
    }
    setInterval(aktualizujCas, 1000);
    aktualizujCas();
  </script>

  <button onclick="toggleTheme()">🌓 Zmeniť režim</button>

<script>
  function toggleTheme() {
    document.body.classList.toggle('dark-mode');
  }
</script>

<style>
  body.dark-mode {
    background-color: #121212;
    color: white;
  }
</style>

  <div id="google_translate_element"></div>
<script type="text/javascript">
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'sk',
      includedLanguages: 'en,cs,fr,hu,de,pl,ro,ru,es,it,uk,sr,bn,ko,ja,zh-CN',
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google_translate_element');
  }
</script>
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
   
  
  <p style="color: orange; font-size: 14px;">
  ⚠️ Táto šachová verzia neobsahuje rošádu ani špeciálny pešiakový ťah (napr. en passant).🧠 V tejto verzii šachu platí: **Pešiak sa nepremení na inú figúru, ani na dámu, ani na koňa. Ak sa pešiak dostane na koniec šachovnice, zostáva pešiakom.Zostáva stáť na mieste – ďalej sa už nemôže pohnúť.🎯 Tento princíp zjednodušuje hru a zároveň posilňuje férovosť a stratégiu – hráč musí rozmýšľať dopredu s tým, čo má. .Ale Je však plne hrateľná podľa pravidiel FIDE!
  </p>
  <p style="color:gray; font-size:12px; text-align:center;">
  V ErikAI Šachy nejde o farbu – ide o ťah. Tu červený ide prvý, a nik sa nesťažuje 😉. 🗯️ „Konečne má čierny výhodu – aspoň na pozadí!“ 😎
  </p>
  <h2 id="turn">Na ťahu: Biely(červeny)</h2>
  <h3 id="status"></h3>
  <div id="board" class="board"></div>
  <button onclick="newGame()">Nová hra</button>
  <button onclick="undoMove()">Späť ťah</button>

<script>
const board = document.getElementById("board");
const turnDisplay = document.getElementById("turn");
const statusDisplay = document.getElementById("status");

const figures = {
  r: "♜", n: "♞", b: "♝", q: "♛", k: "♚", p: "♟",
  R: "♖", N: "♘", B: "♗", Q: "♕", K: "♔", P: "♙"
};

const startPosition = [
  ["r","n","b","q","k","b","n","r"],
  ["p","p","p","p","p","p","p","p"],
  ["","","","","","","",""],
  ["","","","","","","",""],
  ["","","","","","","",""],
  ["","","","","","","",""],
  ["P","P","P","P","P","P","P","P"],
  ["R","N","B","Q","K","B","N","R"]
];

let boardState = [];
let selected = null;
let whiteTurn = true;
let history = [];

function isKingInCheck(isWhite) {
  let kingPos;
  for (let r = 0; r < 8; r++) {
    for (let c = 0; c < 8; c++) {
      let piece = boardState[r][c];
      if (piece === (isWhite ? "K" : "k")) {
        kingPos = [r, c];
        break;
      }
    }
  }

  for (let r = 0; r < 8; r++) {
    for (let c = 0; c < 8; c++) {
      let piece = boardState[r][c];
      if (piece && (isWhite !== (piece === piece.toUpperCase()))) {
        if (isValidMove(piece, r, c, kingPos[0], kingPos[1])) {
          return true;
        }
      }
    }
  }

  return false;
}

function hasAnyValidMove(isWhite) {
  for (let sr = 0; sr < 8; sr++) {
    for (let sc = 0; sc < 8; sc++) {
      let piece = boardState[sr][sc];
      if (piece && (isWhite === (piece === piece.toUpperCase()))) {
        for (let r = 0; r < 8; r++) {
          for (let c = 0; c < 8; c++) {
            if (isValidMove(piece, sr, sc, r, c)) {
              let temp = JSON.parse(JSON.stringify(boardState));
              temp[r][c] = piece;
              temp[sr][sc] = "";
              if (!isKingInCheckSim(temp, isWhite)) {
                return true;
              }
            }
          }
        }
      }
    }
  }
  return false;
}

function isKingInCheckSim(simBoard, isWhite) {
  let kingPos;
  for (let r = 0; r < 8; r++) {
    for (let c = 0; c < 8; c++) {
      let piece = simBoard[r][c];
      if (piece === (isWhite ? "K" : "k")) {
        kingPos = [r, c];
        break;
      }
    }
  }

  for (let r = 0; r < 8; r++) {
    for (let c = 0; c < 8; c++) {
      let piece = simBoard[r][c];
      if (piece && (isWhite !== (piece === piece.toUpperCase()))) {
        if (isValidMove(piece, r, c, kingPos[0], kingPos[1])) {
          return true;
        }
      }
    }
  }

  return false;
}

function drawBoard() {
  board.innerHTML = "";
  for (let r = 0; r < 8; r++) {
    for (let c = 0; c < 8; c++) {
      const cell = document.createElement("div");
      cell.classList.add("cell", (r + c) % 2 === 0 ? "white" : "black");

      const piece = boardState[r][c];
      cell.textContent = figures[piece] || "";

      if (piece) {
        if (piece === piece.toUpperCase()) {
          cell.classList.add("whitePiece");
        } else {
          cell.classList.add("blackPiece");
        }
      }

      cell.onclick = () => onCellClick(r, c);
      board.appendChild(cell);
    }
  }
}

function onCellClick(r, c) {
  const piece = boardState[r][c];
  if (selected) {
    const [sr, sc] = selected;
    const movingPiece = boardState[sr][sc];
    if (isValidMove(movingPiece, sr, sc, r, c)) {
      const backup = JSON.parse(JSON.stringify(boardState));
      boardState[r][c] = movingPiece;
      boardState[sr][sc] = "";
      if (!isInCheck(whiteTurn)) {
        history.push(backup);
        whiteTurn = !whiteTurn;
        turnDisplay.textContent = `Na ťahu: ${whiteTurn ? "Biely(červený)" : "Čierny(žltý)"}`;
        if (isKingInCheck(!whiteTurn)) {
          if (!hasAnyValidMove(!whiteTurn)) {
            statusDisplay.textContent = `Šach-mat! Vyhral ${whiteTurn ? "Biely" : "Čierny"}!`;
          } else {
            statusDisplay.textContent = "Šach!";
          }
        } else if (!hasAnyValidMove(!whiteTurn)) {
          statusDisplay.textContent = "Pat! Remíza.";
        } else {
          statusDisplay.textContent = "";
        }
      } else {
        boardState = backup;
      }
    }
    selected = null;
    drawBoard();
  } else if (piece && (whiteTurn === (piece === piece.toUpperCase()))) {
    selected = [r, c];
  }
}

function isClearRow(sr, sc, r, c) {
  for (let i = Math.min(sc, c) + 1; i < Math.max(sc, c); i++) {
    if (boardState[sr][i] !== "") return false;
  }
  return true;
}

function isClearColumn(sr, sc, r, c) {
  for (let i = Math.min(sr, r) + 1; i < Math.max(sr, r); i++) {
    if (boardState[i][sc] !== "") return false;
  }
  return true;
}

function isClearDiagonal(sr, sc, r, c) {
  let dr = r > sr ? 1 : -1;
  let dc = c > sc ? 1 : -1;
  for (let i = 1; i < Math.abs(r - sr); i++) {
    if (boardState[sr + i * dr][sc + i * dc] !== "") return false;
  }
  return true;
}

function isValidMove(piece, sr, sc, r, c) {
  let dr = r - sr, dc = c - sc;
  let target = boardState[r][c];
  let isWhite = piece === piece.toUpperCase();
  let dir = isWhite ? -1 : 1;
  piece = piece.toLowerCase();

  if (target && (isWhite === (target === target.toUpperCase()))) return false;

  if (piece === "k") return Math.abs(dr) <= 1 && Math.abs(dc) <= 1;
  if (piece === "q") return (dr === 0 && isClearRow(sr, sc, r, c)) || (dc === 0 && isClearColumn(sr, sc, r, c)) || (Math.abs(dr) === Math.abs(dc) && isClearDiagonal(sr, sc, r, c));
  if (piece === "r") return (dr === 0 && isClearRow(sr, sc, r, c)) || (dc === 0 && isClearColumn(sr, sc, r, c));
  if (piece === "b") return Math.abs(dr) === Math.abs(dc) && isClearDiagonal(sr, sc, r, c);
  if (piece === "n") return (Math.abs(dr) === 2 && Math.abs(dc) === 1) || (Math.abs(dr) === 1 && Math.abs(dc) === 2);
  if (piece === "p") {
    if (dc === 0 && target === "") {
      if (dr === dir) return true;
      if ((sr === 6 && isWhite) || (sr === 1 && !isWhite)) return dr === 2 * dir && boardState[sr + dir][sc] === "";
    }
    if (Math.abs(dc) === 1 && dr === dir && target !== "") return true;
    return false;
  }

  return false;
}

function isInCheck(isWhite) {
  let kingPos = [-1, -1];
  for (let r = 0; r < 8; r++) {
    for (let c = 0; c < 8; c++) {
      if (boardState[r][c] === (isWhite ? "K" : "k")) kingPos = [r, c];
    }
  }

  for (let r = 0; r < 8; r++) {
    for (let c = 0; c < 8; c++) {
      let p = boardState[r][c];
      if (p && (isWhite !== (p === p.toUpperCase())) && isValidMove(p, r, c, kingPos[0], kingPos[1])) {
        return true;
      }
    }
  }
  return false;
}

function newGame() {
  boardState = JSON.parse(JSON.stringify(startPosition));
  whiteTurn = true;
  selected = null;
  history = [];
  turnDisplay.textContent = "Na ťahu: Biely";
  statusDisplay.textContent = "";
  drawBoard();
}

function undoMove() {
  if (history.length > 0) {
    boardState = history.pop();
    whiteTurn = !whiteTurn;
    turnDisplay.textContent = `Na ťahu: ${whiteTurn ? "Biely" : "Čierny"}`;
    statusDisplay.textContent = "";
    drawBoard();
  }
}

newGame();
</script>
  <p style="font-size: 14px; color: gray; margin-top: 20px;">
  This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.  
To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-nd/4.0/  
© 2025 Erik Mohylák – All rights reserved.
  </p>
</body>
</html>
