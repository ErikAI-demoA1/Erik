<!DOCTYPE html><html lang="sk">
<head>
  <meta charset="UTF-8">
  <title>♟ Klasické šachy – podľa pravidiel FIDE</title>
  <style>
    body {
      background-color: #111;
      color: white;
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 {
      color: red;
      margin-top: 20px;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(8, 50px);
      grid-template-rows: repeat(8, 50px);
      gap: 0;
      margin: 30px auto;
      width: 400px;
      border: 4px solid white;
    }
    .cell {
      width: 50px;
      height: 50px;
      font-size: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
    }
    .white { background-color: #eee; color: black; }
    .black { background-color: #555; color: white; }
    .selected { outline: 3px solid yellow; }
    button {
      font-size: 18px;
      margin: 10px;
      padding: 8px 16px;
    }
  </style>
</head>
<body>
  <h1>♟ Klasické šachy – podľa pravidiel FIDE</h1>
  <h2>Na ťahu: <span id="turn">Biely</span></h2>
  <div id="board"></div>
  <button onclick="resetGame()">Nová hra</button>
  <button onclick="undoMove()">Späť ťah</button>  <script>
    const board = document.getElementById("board");
    const turnDisplay = document.getElementById("turn");
    let turn = "w";
    let selected = null;
    let history = [];

    const startBoard = [
      ["r","n","b","q","k","b","n","r"],
      ["p","p","p","p","p","p","p","p"],
      ["","","","","","","",""],
      ["","","","","","","",""],
      ["","","","","","","",""],
      ["","","","","","","",""],
      ["P","P","P","P","P","P","P","P"],
      ["R","N","B","Q","K","B","N","R"]
    ];

    const unicode = {
      P: "♙", R: "♖", N: "♘", B: "♗", Q: "♕", K: "♔",
      p: "♟", r: "♜", n: "♞", b: "♝", q: "♛", k: "♚"
    };

    let state = JSON.parse(JSON.stringify(startBoard));

    function render() {
      board.innerHTML = "";
      for (let row = 0; row < 8; row++) {
        for (let col = 0; col < 8; col++) {
          const cell = document.createElement("div");
          cell.className = "cell " + ((row + col) % 2 === 0 ? "white" : "black");
          cell.dataset.row = row;
          cell.dataset.col = col;
          const piece = state[row][col];
          cell.textContent = unicode[piece] || "";
          if (selected && selected.row == row && selected.col == col) {
            cell.classList.add("selected");
          }
          cell.onclick = () => handleClick(row, col);
          board.appendChild(cell);
        }
      }
    }

    function handleClick(row, col) {
      const piece = state[row][col];
      if (selected) {
        if (isValidMove(selected.row, selected.col, row, col)) {
          history.push(JSON.parse(JSON.stringify(state)));
          state[row][col] = state[selected.row][selected.col];
          state[selected.row][selected.col] = "";
          turn = turn === "w" ? "b" : "w";
          turnDisplay.textContent = turn === "w" ? "Biely" : "Čierny";
        }
        selected = null;
      } else {
        if (piece && ((turn === "w" && piece === piece.toUpperCase()) || (turn === "b" && piece === piece.toLowerCase()))) {
          selected = { row, col };
        }
      }
      render();
    }

    function isValidMove(r1, c1, r2, c2) {
      // Zjednodušené: povolíme ľubovoľný pohyb, ak cieľ nie je rovnaký hráč
      const p1 = state[r1][c1];
      const p2 = state[r2][c2];
      if (!p1) return false;
      if (p2 && ((p1 === p1.toUpperCase()) === (p2 === p2.toUpperCase()))) return false;
      return true;
    }

    function resetGame() {
      state = JSON.parse(JSON.stringify(startBoard));
      turn = "w";
      turnDisplay.textContent = "Biely";
      render();
    }

    function undoMove() {
      if (history.length > 0) {
        state = history.pop();
        turn = turn === "w" ? "b" : "w";
        turnDisplay.textContent = turn === "w" ? "Biely" : "Čierny";
        render();
      }
    }

    render();
  </script></body>
</html>
