<!DOCTYPE html><html lang="sk">
<head>
  <meta charset="UTF-8">
  <title>ErikAI Tabu쬶y</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial; text-align: center; margin: 10px; }
    table { border-collapse: collapse; margin: auto; }
    td, th { border: 1px solid #ccc; padding: 3px; width: 70px; height: 22px; }
    input[type='text'] { width: 65px; border: none; text-align: center; }
    button, label { margin: 5px; padding: 8px 16px; font-size: 14px; }
    .green { background-color: #4CAF50; color: white; }
    .blue { background-color: #2196F3; color: white; }
    .yellow { background-color: #FFC107; }
    .red { background-color: #F44336; color: white; }
  </style>
</head>
<body>
<h2>游늵 ErikAI Tabu쬶y</h2>
<p>Maxim치lne rozmery: 100 x 100 (ozna캜enie A1 a CV100)</p>
<input type="file" id="excelFile" accept=".xlsx,.xls,.csv">
<br>
<div id="tableContainer"></div>
<br>
<button class="green" onclick="saveTable()">游 Ulo쬴콘</button>
<button class="blue" onclick="loadTable()">游늬 Na캜칤ta콘</button>
<button class="yellow" onclick="downloadCSV()">游늯 CSV</button>
<button class="red" onclick="clearTable()">游띎 Vymaza콘</button><script>
const tableSize = 100;
const tableContainer = document.getElementById("tableContainer");
const table = document.createElement("table");

function generateTable() {
  const alphabet = [...Array(100)].map((_, i) => String.fromCharCode(65 + i % 26) + (i >= 26 ? String.fromCharCode(65 + Math.floor(i / 26) - 1) : ""));
  const headerRow = document.createElement("tr");
  headerRow.appendChild(document.createElement("th"));
  for (let col = 0; col < tableSize; col++) {
    const th = document.createElement("th");
    th.textContent = alphabet[col];
    headerRow.appendChild(th);
  }
  table.appendChild(headerRow);

  for (let row = 1; row <= tableSize; row++) {
    const tr = document.createElement("tr");
    const rowHeader = document.createElement("th");
    rowHeader.textContent = row;
    tr.appendChild(rowHeader);
    for (let col = 0; col < tableSize; col++) {
      const td = document.createElement("td");
      const input = document.createElement("input");
      input.type = "text";
      td.appendChild(input);
      tr.appendChild(td);
    }
    table.appendChild(tr);
  }
  tableContainer.appendChild(table);
}

function saveTable() {
  const data = [];
  const rows = table.rows;
  for (let i = 1; i < rows.length; i++) {
    const cells = rows[i].cells;
    const rowData = [];
    for (let j = 1; j < cells.length; j++) {
      rowData.push(cells[j].firstChild.value);
    }
    data.push(rowData);
  }
  localStorage.setItem("erikai_table", JSON.stringify(data));
  alert("游 Tabu쬶a bola ulo쬰n치!");
}

function loadTable() {
  const data = JSON.parse(localStorage.getItem("erikai_table") || "[]");
  const rows = table.rows;
  for (let i = 0; i < data.length && i + 1 < rows.length; i++) {
    for (let j = 0; j < data[i].length && j + 1 < rows[i + 1].cells.length; j++) {
      rows[i + 1].cells[j + 1].firstChild.value = data[i][j];
    }
  }
  alert("游늬 Tabu쬶a bola na캜칤tan치!");
}

function clearTable() {
  const inputs = table.querySelectorAll("input");
  inputs.forEach(input => input.value = "");
  alert("游띎 Tabu쬶a bola vymazan치!");
}

function downloadCSV() {
  let csv = "";
  const rows = table.rows;
  for (let i = 1; i < rows.length; i++) {
    const cells = rows[i].cells;
    const row = [];
    for (let j = 1; j < cells.length; j++) {
      row.push(cells[j].firstChild.value);
    }
    csv += row.join(",") + "\n";
  }
  const blob = new Blob([csv], { type: "text/csv" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "tabulka.csv";
  link.click();
}

document.getElementById("excelFile").addEventListener("change", (e) => {
  const file = e.target.files[0];
  const reader = new FileReader();
  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, { type: 'array' });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
    for (let i = 0; i < json.length && i < tableSize; i++) {
      for (let j = 0; j < json[i].length && j < tableSize; j++) {
        table.rows[i + 1].cells[j + 1].firstChild.value = json[i][j] || "";
      }
    }
    alert("游 Excel tabu쬶a bola importovan치!");
  };
  reader.readAsArrayBuffer(file);
});

generateTable();
</script></body>
</html>
