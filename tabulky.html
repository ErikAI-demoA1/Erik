<!DOCTYPE html><html lang="sk">
<head>
  <meta charset="UTF-8">
  <title>ErikAI TabuÄ¾ky</title>
  <style>
    body { font-family: Arial; text-align: center; margin: 20px; }
    table { border-collapse: collapse; margin: auto; }
    td, th { border: 1px solid #ccc; width: 60px; height: 25px; text-align: center; }
    input { width: 100%; height: 100%; border: none; text-align: center; }
    button { margin: 5px; padding: 10px; font-weight: bold; }
    #tabsaved span { margin: 5px; display: inline-block; padding: 5px 10px; background: #eee; border-radius: 5px; cursor: pointer; }
    #tabsaved span:hover { background: #ddd; }
    .deleteBtn { margin-left: 5px; background: #ff6666; border: none; padding: 3px 6px; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>ğŸ“ˆ ErikAI TabuÄ¾ky</h2>
  <p>MaximÃ¡lne rozmery: 100 x 100 (oznÃ¡Äenie A1 aÅ¾ CV100)</p>  <input type="text" id="tabName" placeholder="NÃ¡zov tabuÄ¾ky" value="moja_tabulka"><br><br>

  <table id="spreadsheet"></table>  <br>
  <button onclick="saveTable()">ğŸ“„ UloÅ¾iÅ¥</button>
  <button onclick="loadTable()">ğŸ“‚ NaÄÃ­taÅ¥</button>
  <button onclick="exportCSV()">ğŸ“ƒ CSV</button>
  <button onclick="clearTable()" style="background:#e74c3c; color:white">ğŸ›‹ï¸ VymazaÅ¥</button>
  <br><br>  <div id="message"></div>  <h4>ğŸ—‚ï¸ UloÅ¾enÃ© tabuÄ¾ky:</h4>
  <div id="tabsaved"></div><script>
const table = document.getElementById("spreadsheet");
const message = document.getElementById("message");
const savedContainer = document.getElementById("tabsaved");

function createTable(rows = 100, cols = 100) {
  table.innerHTML = "";
  let thead = table.insertRow();
  thead.insertCell();
  for (let c = 0; c < cols; c++) {
    let cell = thead.insertCell();
    cell.innerText = String.fromCharCode(65 + (c % 26)).repeat(Math.floor(c / 26) + 1);
  }
  for (let r = 1; r <= rows; r++) {
    let row = table.insertRow();
    let th = row.insertCell();
    th.innerText = r;
    for (let c = 0; c < cols; c++) {
      let cell = row.insertCell();
      let input = document.createElement("input");
      cell.appendChild(input);
    }
  }
  updateSavedList();
}

function saveTable() {
  const name = document.getElementById("tabName").value;
  if (!name) return alert("Zadaj nÃ¡zov tabuÄ¾ky.");
  let data = [];
  for (let i = 1; i < table.rows.length; i++) {
    let row = [];
    for (let j = 1; j < table.rows[i].cells.length; j++) {
      row.push(table.rows[i].cells[j].firstChild.value);
    }
    data.push(row);
  }
  localStorage.setItem("table_" + name, JSON.stringify(data));
  message.innerHTML = `âœ… TabuÄ¾ka "${name}" bola ÃºspeÅ¡ne uloÅ¾enÃ¡.`;
  updateSavedList();
}

function loadTable(name = null) {
  const tabname = name || document.getElementById("tabName").value;
  const saved = localStorage.getItem("table_" + tabname);
  if (!saved) return alert("TabuÄ¾ka neexistuje.");
  const data = JSON.parse(saved);
  for (let i = 0; i < data.length; i++) {
    for (let j = 0; j < data[i].length; j++) {
      table.rows[i+1].cells[j+1].firstChild.value = data[i][j];
    }
  }
  message.innerHTML = `ğŸ”„ TabuÄ¾ka "${tabname}" bola naÄÃ­tanÃ¡.`;
}

function clearTable() {
  for (let i = 1; i < table.rows.length; i++) {
    for (let j = 1; j < table.rows[i].cells.length; j++) {
      table.rows[i].cells[j].firstChild.value = "";
    }
  }
  message.innerHTML = "ğŸ›‹ï¸ TabuÄ¾ka bola vymazanÃ¡.";
}

function exportCSV() {
  let csv = "";
  for (let i = 1; i < table.rows.length; i++) {
    let row = [];
    for (let j = 1; j < table.rows[i].cells.length; j++) {
      row.push(table.rows[i].cells[j].firstChild.value);
    }
    csv += row.join(",") + "\n";
  }
  let blob = new Blob([csv], { type: 'text/csv' });
  let url = URL.createObjectURL(blob);
  let a = document.createElement("a");
  a.href = url;
  a.download = "export.csv";
  a.click();
  URL.revokeObjectURL(url);
}

function updateSavedList() {
  savedContainer.innerHTML = "";
  for (let key in localStorage) {
    if (key.startsWith("table_")) {
      const name = key.replace("table_", "");
      let span = document.createElement("span");
      span.innerText = name;
      span.onclick = () => loadTable(name);
      let del = document.createElement("button");
      del.innerText = "âŒ";
      del.className = "deleteBtn";
      del.onclick = (e) => {
        e.stopPropagation();
        localStorage.removeItem("table_" + name);
        updateSavedList();
        message.innerHTML = `âŒ TabuÄ¾ka "${name}" bola vymazanÃ¡.`;
      };
      span.appendChild(del);
      savedContainer.appendChild(span);
    }
  }
}

createTable();
</script></body>
</html>
