<!DOCTYPE html><html lang="sk">
<head>
  <meta charset="UTF-8">
  <title>ErikAI Peer Chat</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; background: #f4f4f4; }
    textarea { width: 100%; height: 100px; margin-bottom: 0.5rem; }
    input[type=text] { width: 100%; margin-bottom: 0.5rem; }
    button { margin: 5px; padding: 10px; }
    .log { height: 150px; background: #fff; overflow-y: auto; border: 1px solid #ccc; padding: 0.5rem; }
  </style>
</head>
<body>
  <h2>üí¨ ErikAI Peer Chat (bez servera)</h2>  <div>
    <button onclick="startConnection()">1Ô∏è‚É£ Spusti spojenie (vytvor OFFER)</button>
    <textarea id="offer" placeholder="Tu sa objav√≠ tvoj offer..."></textarea><textarea id="remoteAnswer" placeholder="Sem vlo≈æ answer z druh√©ho mobilu..."></textarea>
<button onclick="addAnswer()">2Ô∏è‚É£ Vlo≈æi≈• odpoveƒè (ANSWER)</button>

  </div>  <hr>  <div>
    <textarea id="answer" placeholder="Ak ti niekto po≈°le OFFER, vlo≈æ sem..."></textarea>
    <button onclick="createAnswer()">3Ô∏è‚É£ Vytvori≈• odpoveƒè (ANSWER)</button>
    <textarea id="sendAnswer" placeholder="Po≈°li tento answer sp√§≈• druh√©mu..."></textarea>
  </div>  <hr>  <div>
    <input type="text" id="message" placeholder="Nap√≠≈° spr√°vu...">
    <button onclick="sendMessage()">‚úâÔ∏è Posla≈•</button>
    <div class="log" id="chat"></div>
  </div>  <script>
    let pc = new RTCPeerConnection();
    let dc = pc.createDataChannel("chat");
    dc.onmessage = (e) => {
      document.getElementById("chat").innerHTML += `<div><b>üü¢ Prijat√©:</b> ${e.data}</div>`;
    };
    dc.onopen = () => {
      document.getElementById("chat").innerHTML += `<div><i>‚úÖ Spojenie nadviazan√©!</i></div>`;
    };

    async function startConnection() {
      const offer = await pc.createOffer();
      await pc.setLocalDescription(offer);
      document.getElementById("offer").value = JSON.stringify(offer);
    }

    async function addAnswer() {
      const answer = JSON.parse(document.getElementById("remoteAnswer").value);
      await pc.setRemoteDescription(answer);
    }

    pc.ondatachannel = (e) => {
      dc = e.channel;
      dc.onmessage = (ev) => {
        document.getElementById("chat").innerHTML += `<div><b>üü¢ Prijat√©:</b> ${ev.data}</div>`;
      };
    };

    async function createAnswer() {
      const offer = JSON.parse(document.getElementById("answer").value);
      await pc.setRemoteDescription(offer);
      const answer = await pc.createAnswer();
      await pc.setLocalDescription(answer);
      document.getElementById("sendAnswer").value = JSON.stringify(answer);
    }

    function sendMessage() {
      const msg = document.getElementById("message").value;
      dc.send(msg);
      document.getElementById("chat").innerHTML += `<div><b>üîµ Ty:</b> ${msg}</div>`;
      document.getElementById("message").value = "";
    }
  </script></body>
</html>
