<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ErikAI Ludo ‚Äì Mega re≈æim</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f3f3f3;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #1e4e4e;
    }
    select, button {
      padding: 8px;
      margin: 10px;
      font-size: 16px;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(25, 28px);
      grid-template-rows: repeat(25, 28px);
      margin: 0 auto;
      border: 2px solid #999;
      width: fit-content;
    }
    .cell {
      width: 28px;
      height: 28px;
      border: 1px solid #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .triangle {
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-bottom: 18px solid red;
      position: relative;
    }
    .triangle::after {
      content: attr(data-number);
      position: absolute;
      top: -22px;
      font-size: 10px;
      font-weight: bold;
      color: black;
    }
    .player-info {
      margin-top: 10px;
      font-weight: bold;
    }
    footer {
      font-size: 12px;
      color: #444;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>ErikAI Ludo ‚Äì Mega re≈æim</h1>
  <div>
    <label>Poƒçet hr√°ƒçov:</label>
    <select id="playerCount">
      <option>4 hr√°ƒçi</option>
      <option>6 hr√°ƒçov</option>
      <option>8 hr√°ƒçov</option>
      <option>10 hr√°ƒçov</option>
      <option>12 hr√°ƒçov</option>
      <option>16 hr√°ƒçov</option>
      <option selected>20 hr√°ƒçov</option>
    </select>
    <button onclick="rollDice()">Hod kockou üé≤</button>
  </div>
  <div class="player-info" id="info"></div>
  <div class="board" id="board"></div>

  <footer>
    This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. ¬© 2025 Erik Mohyl√°k ‚Äì All rights reserved.
  </footer>

  <script>
    const board = document.getElementById("board");
    const info = document.getElementById("info");
    const colors = ["red", "blue", "green", "yellow", "orange", "purple", "pink", "cyan", "lime", "magenta", "brown", "navy", "black", "gray", "gold", "darkgreen", "darkorange", "violet", "teal", "indigo"];

    let currentPlayer = 0;
    let diceRoll = 0;
    let players = [];

    // Vytvorenie 25x25 gridu
    for (let y = 0; y < 25; y++) {
      for (let x = 0; x < 25; x++) {
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.dataset.x = x;
        cell.dataset.y = y;
        cell.addEventListener("click", () => cellClicked(cell));
        board.appendChild(cell);
      }
    }

    function rollDice() {
      const playerSelect = document.getElementById("playerCount");
      const count = parseInt(playerSelect.value);
      if (players.length !== count) setupPlayers(count);
      if (players[currentPlayer].pos === -1) {
        nextTurn();
        return;
      }

      diceRoll = Math.floor(Math.random() * 6) + 1;
      const color = players[currentPlayer].color;
      info.innerText = `Hr√°ƒç ${currentPlayer + 1} (${color}) hodil: ${diceRoll}. Vyber pol√≠ƒçko na pohyb.`;
    }

    function setupPlayers(count) {
      players = [];
      board.querySelectorAll(".cell").forEach(cell => cell.innerHTML = "");
      const used = new Set();
      for (let i = 0; i < count; i++) {
        const color = colors[i];
        let pos;
        do {
          pos = Math.floor(Math.random() * (25 * 25));
        } while (used.has(pos));
        used.add(pos);

        const cell = board.children[pos];
        const fig = document.createElement("div");
        fig.className = "triangle";
        fig.style.borderBottomColor = color;
        fig.dataset.player = i;
        fig.dataset.number = i + 1;
        cell.appendChild(fig);
        players.push({ color, pos: pos });
      }
    }

    function cellClicked(cell) {
      if (!diceRoll) return;

      const player = players[currentPlayer];
      if (player.pos === -1) return;

      const currentCell = board.children[player.pos];
      const targetIndex = Array.from(board.children).indexOf(cell);
      const dx = Math.abs(cell.dataset.x - currentCell.dataset.x);
      const dy = Math.abs(cell.dataset.y - currentCell.dataset.y);
      const distance = dx + dy;

      if (distance !== diceRoll) {
        info.innerText += ` M√¥≈æe≈° √≠s≈• presne o ${diceRoll} pol√≠ƒçok.`;
        return;
      }

      if (cell.children.length > 0) {
        const otherFig = cell.children[0];
        const otherPlayerIndex = parseInt(otherFig.dataset.player);
        if (otherPlayerIndex !== currentPlayer) {
          players[otherPlayerIndex].pos = -1;
          cell.innerHTML = "";
        } else {
          info.innerText += " Nem√¥≈æe≈° √≠s≈• na svoju fig√∫rku!";
          return;
        }
      }

      board.children[player.pos].innerHTML = "";

      const fig = document.createElement("div");
      fig.className = "triangle";
      fig.style.borderBottomColor = player.color;
      fig.dataset.player = currentPlayer;
      fig.dataset.number = currentPlayer + 1;
      cell.appendChild(fig);
      player.pos = targetIndex;

      diceRoll = 0;
      nextTurn();
    }

    function nextTurn() {
      currentPlayer = (currentPlayer + 1) % players.length;
      const nextColor = players[currentPlayer].color;
      info.innerText = `Hr√°ƒç ${currentPlayer + 1} (${nextColor}) na ≈•ahu. Klikni ‚ÄûHod kockou üé≤‚Äú.`;
    }
  </script>
</body>
</html>
