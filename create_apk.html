<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <title>ErikAI – Vytvor si vlastnú PWA appku</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f1f2f6;
    }
    textarea, input {
      width: 100%;
      margin-bottom: 10px;
      padding: 8px;
    }
    button {
      padding: 10px 20px;
      font-weight: bold;
      margin-right: 10px;
      border: none;
      background: #2ecc71;
      color: white;
      border-radius: 6px;
    }
    #preview {
      width: 100%;
      height: 400px;
      border: 1px solid #ccc;
      margin-top: 20px;
      background: white;
    }
  </style>
</head>
<body>

<h2>ErikAI - Vytvor si vlastnú PWA appku</h2>

<label>Názov tvojej appky:</label>
<input id="appName" placeholder="Napr. MojaErikAIApp" />

<label>HTML kód tvojej aplikácie:</label>
<textarea id="htmlCode" placeholder="Sem vlož svoj ErikAI HTML kód..." rows="10"></textarea>

<button onclick="zobrazNahlad()">Zobraziť náhľad</button>
<button onclick="stiahniZip()">Stiahnuť ako PWA (.zip)</button>

<iframe id="preview"></iframe>

<script>
function zobrazNahlad() {
  const html = document.getElementById("htmlCode").value;
  document.getElementById("preview").srcdoc = html;
}

function stiahniZip() {
  const name = document.getElementById("appName").value || "MojaApp";
  const htmlContent = document.getElementById("htmlCode").value;

  const manifest = {
    name: name,
    short_name: name,
    start_url: "./index.html",
    display: "standalone",
    background_color: "#ffffff",
    theme_color: "#00a8ff",
    icons: [{
      src: "icon.png",
      sizes: "192x192",
      type: "image/png"
    }]
  };

  const serviceWorker = `
self.addEventListener('fetch', function(event) {
  event.respondWith(fetch(event.request).catch(function() {
    return new Response('Offline');
  }));
});
  `;

  const iconBase64 = "iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAKlBMVEX///+AgIB/f3+fn59vb2+SkpKUlJSwsLCEhIS5ubmPj4+FhYWioqKsrsXIAAAABnRSTlMAAAAAAABupgeRAAAAHUlEQVQImWNgwAIAAAQAAf//AwAGBgYGBgYGBgYAAAwB8rUD8f2NLIAAAAASUVORK5CYII=";

  const zip = new JSZip();
  zip.file("index.html", htmlContent);
  zip.file("manifest.json", JSON.stringify(manifest, null, 2));
  zip.file("service-worker.js", serviceWorker);
  zip.file("icon.png", iconBase64, { base64: true });

  zip.generateAsync({ type: "blob" }).then(function(content) {
    const a = document.createElement("a");
    a.href = URL.createObjectURL(content);
    a.download = `${name}_PWA.zip`;
    a.click();
  });
}
</script>

</body>
</html>
