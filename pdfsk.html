<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <title>ErikAI PDFsk</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f9f9f9;
    }
    h1 {
      color: #1a73e8;
    }
    .section {
      margin-top: 20px;
    }
    button {
      margin: 5px;
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    .green { background-color: #28a745; }
    .orange { background-color: #f0ad4e; }
    .yellow { background-color: #ffc107; color: black; }
    .danger { background-color: #dc3545; }
    .tag {
      display: inline-block;
      padding: 5px 10px;
      background-color: #fff3cd;
      color: #856404;
      border-radius: 5px;
      margin: 3px;
    }
    #warning {
      display: none;
      background-color: #fff3cd;
      color: #856404;
      border: 1px solid #ffeeba;
      padding: 10px;
      margin-top: 15px;
      border-radius: 6px;
    }
  </style>
</head>
<body>

  <h1>ğŸ“˜ ErikAI PDFsk</h1>

  <div class="section">
    <strong>Vyber PDF s obrÃ¡zkami:</strong><br>
    <input type="file" id="fileInput" accept=".pdf">
    <div id="selectedFile" style="margin-top: 8px; font-weight: bold; color: green;"></div>
  </div>

  <div id="warning">
    âš ï¸ <strong>Upozornenie:</strong> Tento PDF sÃºbor vyzerÃ¡ ako naskenovanÃ½ obrÃ¡zok a neobsahuje ÄitateÄ¾nÃ½ text.
    Export do Wordu, Textu alebo Excelu nemusÃ­ fungovaÅ¥ sprÃ¡vne.
  </div>

  <div class="section">
    <strong>ğŸ“ MoÅ¾nosti konverzie:</strong><br>
    <button class="green" onclick="downloadFormat('text')">ğŸ“„ StiahnuÅ¥ ako Text</button>
    <button class="green" onclick="downloadFormat('word')">ğŸ“„ StiahnuÅ¥ ako Word</button>
    <button class="green" onclick="downloadFormat('excel')">ğŸ“Š StiahnuÅ¥ ako Excel</button>
  </div>

  <div class="section">
    <strong>ğŸ“‚ LokÃ¡lna prÃ¡ca:</strong><br>
    <button class="orange" onclick="saveLocal()">ğŸ’¾ UloÅ¾iÅ¥ PDF lokÃ¡lne</button>
    <button class="orange" onclick="loadLocal()">ğŸ“‚ NaÄÃ­taÅ¥ PDF</button>
  </div>

  <div class="section">
    <strong>ğŸ“– UloÅ¾enÃ© PDF dokumenty:</strong><br>
    <div id="pdfList"></div>
  </div>

  <script>
    let currentPDF = null;

    function showWarningIfImageOnly(content) {
      const hasText = /\/Font|\/Text|\/Contents/.test(content);
      document.getElementById('warning').style.display = hasText ? 'none' : 'block';
    }

    document.getElementById('fileInput').addEventListener('change', function () {
      const file = this.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function () {
        const content = reader.result;
        currentPDF = { name: file.name, content: content };
        document.getElementById('selectedFile').textContent = `âœ… SÃºbor: ${file.name}`;
        showWarningIfImageOnly(content);
      };
      reader.readAsText(file);
    });

    function downloadFormat(format) {
      if (!currentPDF) {
        alert("âŒ Najprv vyber PDF sÃºbor.");
        return;
      }

      const blob = new Blob([currentPDF.content], { type: "text/plain" });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      let ext = format === "text" ? ".txt" : format === "word" ? ".doc" : ".xls";
      link.download = currentPDF.name.replace(".pdf", ext);
      link.click();
    }

    function saveLocal() {
      if (!currentPDF) {
        alert("âŒ NemÃ¡Å¡ Å¾iadny sÃºbor na uloÅ¾enie.");
        return;
      }
      localStorage.setItem("pdf_" + currentPDF.name, currentPDF.content);
      updatePDFList();
    }

    function loadLocal() {
      const keys = Object.keys(localStorage).filter(k => k.startsWith("pdf_"));
      if (keys.length === 0) return;

      const name = keys[0].replace("pdf_", "");
      const content = localStorage.getItem(keys[0]);
      currentPDF = { name: name, content: content };
      document.getElementById('selectedFile').textContent = `âœ… SÃºbor: ${name}`;
      showWarningIfImageOnly(content);
    }

    function updatePDFList() {
      const list = document.getElementById("pdfList");
      list.innerHTML = "";
      Object.keys(localStorage).forEach(k => {
        if (k.startsWith("pdf_")) {
          const fileName = k.replace("pdf_", "");
          const span = document.createElement("span");
          span.className = "tag";
          span.textContent = fileName;
          span.onclick = () => {
            currentPDF = { name: fileName, content: localStorage.getItem(k) };
            document.getElementById('selectedFile').textContent = `âœ… SÃºbor: ${fileName}`;
            showWarningIfImageOnly(currentPDF.content);
          };

          const removeBtn = document.createElement("button");
          removeBtn.textContent = "âŒ";
          removeBtn.className = "danger";
          removeBtn.style.marginLeft = "8px";
          removeBtn.onclick = () => {
            localStorage.removeItem(k);
            updatePDFList();
            if (currentPDF && currentPDF.name === fileName) {
              currentPDF = null;
              document.getElementById("selectedFile").textContent = "";
              document.getElementById("warning").style.display = "none";
            }
          };

          const wrapper = document.createElement("div");
          wrapper.appendChild(span);
          wrapper.appendChild(removeBtn);
          list.appendChild(wrapper);
        }
      });
    }

    updatePDFList();
  </script>

</body>
</html>
