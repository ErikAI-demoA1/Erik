<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <title>游 ErikAI Kombin치tor Obr치zkov (Mix)</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; background: #f6f6f6; }
    h1 { color: #b30000; }
    input, button { margin: 10px; padding: 10px; font-size: 16px; }
    #vysledok img { max-width: 90%; margin-top: 20px; border-radius: 10px; border: 2px solid #ccc; }
  </style>
</head>
<body>
  <h1>游 <b style="color:#cc0000;">ErikAI Kombin치tor Obr치zkov (Mix)</b></h1>
  <p>Vyber 2 obr치zky a ErikAI ich premie코a n치hodne ako umelec:</p>

  <input type="file" id="obrazok1"><br>
  <input type="file" id="obrazok2"><br>

  <button onclick="kombinujNahodne()">游 Kombinuj obr치zky n치hodne</button>
  <div id="vysledok"></div>

  <script>
    const efekty = ["rotate", "mirror", "hue", "contrast", "dual", "glitch"];

    function nahodneEfekty(pocet = 3) {
      const shuffled = efekty.sort(() => 0.5 - Math.random());
      const vybrane = shuffled.slice(0, Math.floor(Math.random() * 4) + 2); // 2 a 5 efektov
      return vybrane;
    }

    function kombinujNahodne() {
      const o1 = document.getElementById("obrazok1").files[0];
      const o2 = document.getElementById("obrazok2").files[0];
      const resultDiv = document.getElementById("vysledok");

      if (!o1 || !o2) {
        resultDiv.innerHTML = "丘멆잺 Nahraj oba obr치zky!";
        return;
      }

      const reader1 = new FileReader();
      const reader2 = new FileReader();

      reader1.onload = function (e1) {
        reader2.onload = function (e2) {
          const img1 = new Image();
          const img2 = new Image();
          img1.src = e1.target.result;
          img2.src = e2.target.result;

          img1.onload = () => {
            img2.onload = () => {
              const canvas = document.createElement("canvas");
              const ctx = canvas.getContext("2d");
              canvas.width = Math.max(img1.width, img2.width);
              canvas.height = Math.max(img1.height, img2.height);

              const efektyPouzite = nahodneEfekty();

              // Reset transform치cie
              ctx.setTransform(1, 0, 0, 1, 0, 0);
              ctx.clearRect(0, 0, canvas.width, canvas.height);

              for (let efekt of efektyPouzite) {
                switch (efekt) {
                  case "rotate":
                    ctx.translate(canvas.width / 2, canvas.height / 2);
                    ctx.rotate((Math.random() * 0.4) - 0.2); // rot치cia 췀0.2 rad
                    ctx.translate(-canvas.width / 2, -canvas.height / 2);
                    break;
                  case "mirror":
                    ctx.scale(-1, 1);
                    ctx.translate(-canvas.width, 0);
                    break;
                  case "hue":
                    ctx.filter = `hue-rotate(${Math.floor(Math.random() * 360)}deg)`;
                    break;
                  case "contrast":
                    ctx.filter = `contrast(${1 + Math.random() * 0.5}) brightness(${1 + Math.random() * 0.2})`;
                    break;
                  case "dual":
                    ctx.globalAlpha = 1;
                    ctx.drawImage(img1, 0, 0);
                    ctx.globalAlpha = 0.4 + Math.random() * 0.4;
                    ctx.drawImage(img2, 0, 0);
                    break;
                  case "glitch":
                    ctx.drawImage(img2, Math.random() * 30, Math.random() * 30);
                    break;
                }
              }

              // Ak e코te neboli obr치zky nakreslen칠 (napr. bez dual/glitch)
              if (!efektyPouzite.includes("dual") && !efektyPouzite.includes("glitch")) {
                ctx.globalAlpha = 1;
                ctx.drawImage(img1, 0, 0);
                ctx.globalAlpha = 0.5;
                ctx.drawImage(img2, 0, 0);
              }

              resultDiv.innerHTML = `<img src="${canvas.toDataURL()}" alt="Mix obr치zkov">`;
            };
          };
        };
        reader2.readAsDataURL(o2);
      };
      reader1.readAsDataURL(o1);
    }
  </script>
</body>
</html>
