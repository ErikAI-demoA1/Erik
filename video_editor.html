<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <title>ErikAI Video Editor</title>
  <script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.11.8/dist/ffmpeg.min.js"></script>
  <style>
    body { font-family: sans-serif; background: #111; color: white; text-align: center; padding: 20px; }
    input, button { padding: 10px; margin: 5px; }
    video { width: 90%; max-width: 500px; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>🎬 ErikAI Video Editor</h1>
  <input type="file" id="videoFile" accept="video/*"><br>
  Od (s): <input type="number" id="startTime" value="0" min="0">
  Do (s): <input type="number" id="endTime" value="10" min="1"><br>
  <button onclick="trimVideo()">✂️ Strihnúť video</button><br><br>
  <div id="status">🕓 Pripravené</div>
  <video id="preview" controls></video><br>
  <a id="downloadLink" style="display:none;" download="strihnute_video.mp4">⬇️ Stiahnuť zostrihané video</a>

<script>
  const { createFFmpeg, fetchFile } = FFmpeg;
  const ffmpeg = createFFmpeg({ log: true });

  async function trimVideo() {
    const fileInput = document.getElementById('videoFile');
    const start = document.getElementById('startTime').value;
    const end = document.getElementById('endTime').value;
    const preview = document.getElementById('preview');
    const downloadLink = document.getElementById('downloadLink');
    const status = document.getElementById('status');

    if (!fileInput.files.length) {
      alert("Vyber najskôr video.");
      return;
    }

    const file = fileInput.files[0];
    const fileName = 'input.mp4';
    const outputName = 'output.mp4';

    status.innerText = "🔄 Načítavam FFmpeg...";
    if (!ffmpeg.isLoaded()) await ffmpeg.load();

    status.innerText = "📥 Načítavam video...";
    ffmpeg.FS('writeFile', fileName, await fetchFile(file));

    status.innerText = "✂️ Strihám video...";
    await ffmpeg.run('-i', fileName, '-ss', start, '-to', end, '-c', 'copy', outputName);

    const data = ffmpeg.FS('readFile', outputName);
    const videoBlob = new Blob([data.buffer], { type: 'video/mp4' });
    const url = URL.createObjectURL(videoBlob);

    preview.src = url;
    downloadLink.href = url;
    downloadLink.style.display = 'inline';
    status.innerText = "✅ Hotovo!";
  }
</script>
</body>
</html>
