<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <title>ErikAI Video Editor</title>
  <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.12.6/dist/ffmpeg.min.js"></script>
</head>
<body style="background:#111;color:#fff;text-align:center">

  <h1>üé¨ ErikAI Video Editor</h1>
  <input type="file" id="videoFile" accept="video/mp4"><br><br>

  Od (s): <input type="number" id="start" value="0">
  Do (s): <input type="number" id="end" value="10">
  <br><br>

  <button onclick="trimVideo()">‚úÇÔ∏è Strihn√∫≈• video</button>
  <p id="status">Stav: ƒåak√°m na v√Ωber videa...</p>

  <video id="preview" controls style="width:90%;margin-top:15px"></video>
  <br>
  <a id="downloadLink" style="color:lime;font-weight:bold"></a>

  <script>
    const { createFFmpeg, fetchFile } = FFmpeg;
    const ffmpeg = createFFmpeg({ log: true });

    async function trimVideo() {
      const fileInput = document.getElementById('videoFile');
      const start = document.getElementById('start').value;
      const end = document.getElementById('end').value;
      const status = document.getElementById('status');

      if (!fileInput.files[0]) {
        status.innerText = "‚ùå Pros√≠m, vyber video.";
        return;
      }

      status.innerText = "‚öôÔ∏è Naƒç√≠tavam FFmpeg...";
      if (!ffmpeg.isLoaded()) await ffmpeg.load();

      const file = fileInput.files[0];
      const fileName = "input.mp4";
      const outputName = "output.mp4";

      ffmpeg.FS('writeFile', fileName, await fetchFile(file));

      status.innerText = "‚úÇÔ∏è Strih√°m video...";
      await ffmpeg.run(
        '-i', fileName,
        '-ss', start,
        '-to', end,
        '-c', 'copy',
        outputName
      );

      const data = ffmpeg.FS('readFile', outputName);
      const videoBlob = new Blob([data.buffer], { type: 'video/mp4' });
      const videoURL = URL.createObjectURL(videoBlob);

      document.getElementById('preview').src = videoURL;
      const link = document.getElementById('downloadLink');
      link.href = videoURL;
      link.download = "trimmed_erikai.mp4";
      link.innerText = "‚¨áÔ∏è Stiahni zostrihan√© video";

      status.innerText = "‚úÖ Hotovo!";
    }
  </script>

</body>
</html>
